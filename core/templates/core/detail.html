{% extends "base.html" %}
{% load static %}

{% block title %} {{ product.name }} {% endblock %}


{% block content %}
<div class="main">
    <div class="container">
        <div class="detail">
            <div class="detail__up">
                <div class='detail__image-wrapper'>
                    <div class='detail__image'>
                        <img src="{% if product.image %}{{ product.image.url }}{% else %}
                                    {% static 'main/image/no_image.svg' %}{% endif %}">
                    </div>
                    <div class="quantityButton">
                        <form action="#" method="post">
                            <input class="product__buy-btn" type="submit" value="Добавить в корзину">
                        </form>
                    </div>
                    <!-- <button class="product__buy-btn">Купить</button> -->
                </div>
                <div class="detail__product-wrapper">
                    <div>
                        <h1 class='product__title'>{{ product.name }}</h1>
                        <table class='feature'>
                            <tbody>
                                 <tr>
                                      <th>Дата публикации:</th>
                                      <td>13.03.23</td>
                                  </tr>
                                  <tr>
                                      <th>Категории:</th>
                                      <td><a href="/?category={{category.id}}">
                                        {{ product.category }}</a> 
                                      </td>
                                  </tr>
                                  <tr>
                                    <th>Описание:</th>
                                    <td>{{product.description}}</td>
                                </tr>
                                  <tr>
                                      <th>Урожайность:</th>
                                      <td>{{product.productivity}}</td>
                                  </tr>
                                  <tr>
                                    <th>Количество:</th>
                                    <td>{{product.unit}} {{product.unitName}}</td>
                                  </tr>
                                  <tr>
                                    <th>Цена:</th>
                                    <td>{{product.price}} {{product.currency}}</td>
                                  </tr>
                            </tbody>
                         </table>
                    </div>
                </div>
            </div>
            <div class='comments__item'> 
                <div class="comments__item-inner"> 
                    <div class='comments'>
                        <div class="comments__total-count"> Отзывы
                            <!-- <div class="sort-in-row">Сортировать по:
                                <ul>
                                    <li class=" date active-desc"><span>дате</span></li>
                                    <li class=" rating"><span>рейтингу</span></li>
                                    <li class=" useful"><span>полезности</span></li>
                                </ul>
                            </div> -->
                            <div> Всего:  <span>
                                {% with product.comments.count as total_comments %}
                                {{ total_comments }}
                                {% endwith %}</span>  
                            </div>

                        </div>
                        <div class='comments__input-wrapper'>
                            <div class='comments__input-wrapper'>
                                <ul>
                                    {% for comment in product.comments.all %}
                                    <li> 
                                        <span class="comments__user-name">{{ comment.user }} </span> <span class="date"> {{ comment.created_on }} </span> 
                                        <p class='comments__item-textarea' 
                                        type="text" 
                                        readonly> {{ comment.text }} </p>
                                    </li>
                                    {% empty %}
                                        
                                    {% endfor %}    
                                 </ul>                                   
                                  
                            </div>
                        </div> <br>
                                                       
                    
                        {% if request.user.is_authenticated %}

                            <form action="" id="add_form" method="post" >
                                {% csrf_token %}
                                {{ form.as_p }}
                            </form>
                            <button class="comments__add-btn" form="add_form" > Добавить отзыв </button>
                        {% else %}
                        <p> Чтобы оставить отзыв, надо зарегистрироваться </p> <br>
                        <a href="{% url 'signup' %}" class="comments__add-btn">Регистрация</a>

                        {% endif %}
                    </div>

                                  
{% endblock %}

